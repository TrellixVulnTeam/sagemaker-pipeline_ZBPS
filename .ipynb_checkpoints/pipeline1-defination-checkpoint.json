{"Version": "2020-12-01", "Metadata": {}, "Parameters": [{"Name": "ProcessingInstanceType", "Type": "String", "DefaultValue": "ml.m5.xlarge"}, {"Name": "ProcessingInstanceCount", "Type": "Integer", "DefaultValue": 1}, {"Name": "TrainingInstanceType", "Type": "String", "DefaultValue": "ml.m5.xlarge"}, {"Name": "ModelApprovalStatus", "Type": "String", "DefaultValue": "PendingManualApproval"}, {"Name": "InputData", "Type": "String", "DefaultValue": "s3://sagemaker-pipelines-poc/features.csv"}], "PipelineExperimentConfig": {"ExperimentName": {"Get": "Execution.PipelineName"}, "TrialName": {"Get": "Execution.PipelineExecutionId"}}, "Steps": [{"Name": "Pipeline1-Process", "Type": "Processing", "Arguments": {"ProcessingResources": {"ClusterConfig": {"InstanceType": {"Get": "Parameters.ProcessingInstanceType"}, "InstanceCount": {"Get": "Parameters.ProcessingInstanceCount"}, "VolumeSizeInGB": 30}}, "AppSpecification": {"ImageUri": "683313688378.dkr.ecr.us-east-1.amazonaws.com/sagemaker-scikit-learn:0.23-1-cpu-py3", "ContainerEntrypoint": ["python3", "/opt/ml/processing/input/code/preprocessing.py"]}, "RoleArn": "arn:aws:iam::996973542545:role/service-role/AmazonSageMaker-ExecutionRole-20200724T151190", "ProcessingInputs": [{"InputName": "input-1", "AppManaged": false, "S3Input": {"S3Uri": {"Get": "Parameters.InputData"}, "LocalPath": "/opt/ml/processing/input", "S3DataType": "S3Prefix", "S3InputMode": "File", "S3DataDistributionType": "FullyReplicated", "S3CompressionType": "None"}}, {"InputName": "code", "AppManaged": false, "S3Input": {"S3Uri": "s3://sagemaker-us-east-1-996973542545/sklearn-pipeline_1-process-2021-06-28-20-24-59-640/input/code/preprocessing.py", "LocalPath": "/opt/ml/processing/input/code", "S3DataType": "S3Prefix", "S3InputMode": "File", "S3DataDistributionType": "FullyReplicated", "S3CompressionType": "None"}}], "ProcessingOutputConfig": {"Outputs": [{"OutputName": "train", "AppManaged": false, "S3Output": {"S3Uri": "s3://sagemaker-us-east-1-996973542545/sklearn-pipeline_1-process-2021-06-28-20-24-59-640/output/train", "LocalPath": "/opt/ml/processing/train", "S3UploadMode": "EndOfJob"}}, {"OutputName": "validation", "AppManaged": false, "S3Output": {"S3Uri": "s3://sagemaker-us-east-1-996973542545/sklearn-pipeline_1-process-2021-06-28-20-24-59-640/output/validation", "LocalPath": "/opt/ml/processing/validation", "S3UploadMode": "EndOfJob"}}, {"OutputName": "test", "AppManaged": false, "S3Output": {"S3Uri": "s3://sagemaker-us-east-1-996973542545/sklearn-pipeline_1-process-2021-06-28-20-24-59-640/output/test", "LocalPath": "/opt/ml/processing/test", "S3UploadMode": "EndOfJob"}}]}}}, {"Name": "Pipline1-Train", "Type": "Training", "Arguments": {"AlgorithmSpecification": {"TrainingInputMode": "File", "TrainingImage": "683313688378.dkr.ecr.us-east-1.amazonaws.com/sagemaker-xgboost:1.0-1-cpu-py3"}, "OutputDataConfig": {"S3OutputPath": "s3://sagemaker-pipelines-poc/Pipline1-Train"}, "StoppingCondition": {"MaxRuntimeInSeconds": 86400}, "ResourceConfig": {"InstanceCount": 1, "InstanceType": {"Get": "Parameters.TrainingInstanceType"}, "VolumeSizeInGB": 30}, "RoleArn": "arn:aws:iam::996973542545:role/service-role/AmazonSageMaker-ExecutionRole-20200724T151190", "InputDataConfig": [{"DataSource": {"S3DataSource": {"S3DataType": "S3Prefix", "S3Uri": {"Get": "Steps.Pipeline1-Process.ProcessingOutputConfig.Outputs['train'].S3Output.S3Uri"}, "S3DataDistributionType": "FullyReplicated"}}, "ContentType": "text/csv", "ChannelName": "train"}, {"DataSource": {"S3DataSource": {"S3DataType": "S3Prefix", "S3Uri": {"Get": "Steps.Pipeline1-Process.ProcessingOutputConfig.Outputs['validation'].S3Output.S3Uri"}, "S3DataDistributionType": "FullyReplicated"}}, "ContentType": "text/csv", "ChannelName": "validation"}], "HyperParameters": {"objective": "reg:linear", "num_round": "50", "max_depth": "5", "eta": "0.2", "gamma": "4", "min_child_weight": "6", "subsample": "0.7", "silent": "0"}, "ProfilerRuleConfigurations": [{"RuleConfigurationName": "ProfilerReport-1624911899", "RuleEvaluatorImage": "503895931360.dkr.ecr.us-east-1.amazonaws.com/sagemaker-debugger-rules:latest", "RuleParameters": {"rule_to_invoke": "ProfilerReport"}}], "ProfilerConfig": {"S3OutputPath": "s3://sagemaker-pipelines-poc/Pipline1-Train"}}}, {"Name": "Pipeline1-CreateModel", "Type": "Model", "Arguments": {"ExecutionRoleArn": "arn:aws:iam::996973542545:role/service-role/AmazonSageMaker-ExecutionRole-20200724T151190", "PrimaryContainer": {"Image": "683313688378.dkr.ecr.us-east-1.amazonaws.com/sagemaker-xgboost:1.0-1-cpu-py3", "Environment": {}, "ModelDataUrl": {"Get": "Steps.Pipline1-Train.ModelArtifacts.S3ModelArtifacts"}}}}, {"Name": "Pipeline1-Eval", "Type": "Processing", "Arguments": {"ProcessingResources": {"ClusterConfig": {"InstanceType": {"Get": "Parameters.ProcessingInstanceType"}, "InstanceCount": 1, "VolumeSizeInGB": 30}}, "AppSpecification": {"ImageUri": "683313688378.dkr.ecr.us-east-1.amazonaws.com/sagemaker-xgboost:1.0-1-cpu-py3", "ContainerEntrypoint": ["python3", "/opt/ml/processing/input/code/evaluation.py"]}, "RoleArn": "arn:aws:iam::996973542545:role/service-role/AmazonSageMaker-ExecutionRole-20200724T151190", "ProcessingInputs": [{"InputName": "input-1", "AppManaged": false, "S3Input": {"S3Uri": {"Get": "Steps.Pipline1-Train.ModelArtifacts.S3ModelArtifacts"}, "LocalPath": "/opt/ml/processing/model", "S3DataType": "S3Prefix", "S3InputMode": "File", "S3DataDistributionType": "FullyReplicated", "S3CompressionType": "None"}}, {"InputName": "input-2", "AppManaged": false, "S3Input": {"S3Uri": {"Get": "Steps.Pipeline1-Process.ProcessingOutputConfig.Outputs['test'].S3Output.S3Uri"}, "LocalPath": "/opt/ml/processing/test", "S3DataType": "S3Prefix", "S3InputMode": "File", "S3DataDistributionType": "FullyReplicated", "S3CompressionType": "None"}}, {"InputName": "code", "AppManaged": false, "S3Input": {"S3Uri": "s3://sagemaker-us-east-1-996973542545/script-pipline-eval-2021-06-28-20-24-59-832/input/code/evaluation.py", "LocalPath": "/opt/ml/processing/input/code", "S3DataType": "S3Prefix", "S3InputMode": "File", "S3DataDistributionType": "FullyReplicated", "S3CompressionType": "None"}}], "ProcessingOutputConfig": {"Outputs": [{"OutputName": "evaluation", "AppManaged": false, "S3Output": {"S3Uri": "s3://sagemaker-us-east-1-996973542545/script-pipline-eval-2021-06-28-20-24-59-033/output/evaluation", "LocalPath": "/opt/ml/processing/evaluation", "S3UploadMode": "EndOfJob"}}]}}, "PropertyFiles": [{"PropertyFileName": "EvaluationReport", "OutputName": "evaluation", "FilePath": "evaluation.json"}]}, {"Name": "DeployModel", "Type": "Processing", "Arguments": {"ProcessingResources": {"ClusterConfig": {"InstanceType": "ml.t3.medium", "InstanceCount": 1, "VolumeSizeInGB": 30}}, "AppSpecification": {"ImageUri": "683313688378.dkr.ecr.us-east-1.amazonaws.com/sagemaker-scikit-learn:0.23-1-cpu-py3", "ContainerArguments": ["--model-name", {"Get": "Steps.Pipeline1-CreateModel.ModelName"}, "--region", "us-east-1", "--endpoint-instance-type", "ml.t3.medium", "--endpoint-name", "pipeline-deploy-endpoint"], "ContainerEntrypoint": ["python3", "/opt/ml/processing/input/code/deploy.py"]}, "RoleArn": "arn:aws:iam::996973542545:role/service-role/AmazonSageMaker-ExecutionRole-20200724T151190", "ProcessingInputs": [{"InputName": "code", "AppManaged": false, "S3Input": {"S3Uri": "s3://sagemaker-us-east-1-996973542545/demo-deploy-model-2021-06-28-20-24-59-973/input/code/deploy.py", "LocalPath": "/opt/ml/processing/input/code", "S3DataType": "S3Prefix", "S3InputMode": "File", "S3DataDistributionType": "FullyReplicated", "S3CompressionType": "None"}}]}}]}